{"version":3,"sources":["liff_inital_js_template_v3.js"],"names":["ArrLiffQueryString","EncodeQuertstring","ArrQuertString","$","ajax","url","checkStart","apiDomain","res","type","log","success","hide","console","show","xhr","GetLiffId","DecondeUtf8","decodestring","decodeString","decodeURIComponent","GetArrQueryString","queryString","strUrl","aryPara","indexOf","getPara","split","getSearch","length","j","push","ParaVal","GetInLiffAppQuertString","search","location","i","InitializeLineLiffSdk","liffId","init","then","alert","Login","catch","err","code","KeepInitializeLineLiffSdk","os","isClient","liff","isInClient","isLoggedIn","userAccessToken","getAccessToken","decodeedIdToken","getContext","contextType","contextUserId","contextUtouId","contextRoomId","contextGroupId","context","viewType","contextViewType","userId","utouId","roomId","profileUserId","window","localStorage","setItem","profileDisplayName","profile","displayName","profilePictureUrl","pictureUrl","profileStatusMessage","statusMessage","message","login","document","ready","on","test","navigator","userAgent"],"mappings":"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","file":"liff_inital_js_template_v3.js","sourcesContent":["var ArrLiffQueryString;\r\nvar EncodeQuertstring;\r\nvar DecodeQueryString;\r\nvar ArrQuertString;\r\n\r\nfunction checkStart(){\r\n  $.ajax({\r\n    url: apiDomain+'/api/shaklee/checkenable',\r\n    type: 'GET',\r\n    success: function (res) {\r\n      console.log(res);\r\n      $('#load').hide();\r\n      if(res.success){\r\n        $('#mainBody').show();\r\n      }else{\r\n        $('#mainBody').hide();\r\n        $('#wait').show();\r\n      }\r\n    },\r\n    error: function (xhr) {\r\n      console.log(xhr)\r\n    }\r\n  });\r\n}\r\n$(document).ready(function () {\r\n  $('#load').show();\r\n  $('.btn').on('click',function () {\r\n    $('#load').show();\r\n  })\r\n  setTimeout(() => {\r\n    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\r\n      //mobile:只顯示網頁，讓人用掃的才能開啟\r\n      console.log('mobile');\r\n      //LIFF初始化是這段\r\n      InitializeLineLiffSdk();\r\n    \r\n      //這邊是解LIFF導轉之後特有的解QueryString\r\n      ArrLiffQueryString = GetInLiffAppQuertString();\r\n      // EncodeQuertstring = ArrLiffQueryString[\"liff.state\"];\r\n      // DecodeQueryString = DecondeUtf8(EncodeQuertstring);\r\n      // ArrQuertString = GetArrQueryString(DecodeQueryString);\r\n      console.log(ArrLiffQueryString['debug']);\r\n      if(ArrLiffQueryString['debug']=='1'){\r\n        // 直接開始\r\n        console.log('直接開始')\r\n        $('#load').hide();\r\n        $('#mainBody').show();\r\n  \r\n      }else{\r\n        // 打API判斷活動是否開始\r\n        console.log('打API判斷活動是否開始')\r\n        checkStart();\r\n      }\r\n  \r\n    } else {\r\n      //pc:顯示qrcode\r\n        $('#load').hide();\r\n        $('#QRCode').show();\r\n      $('#mainBody').hide();\r\n    }\r\n  }, 500);\r\n});\r\n\r\nfunction GetLiffId() {\r\n  //這段會依照每個帳戶不同更改\r\n  return \"1654884078-0nYB68dJ\";\r\n}\r\n\r\nfunction DecondeUtf8(decodestring) {\r\n  var decodeString = decodeURIComponent(decodestring);\r\n  console.log(decodeString);\r\n  return decodeString;\r\n}\r\n\r\nfunction GetArrQueryString(queryString) {\r\n  var strUrl = queryString;\r\n  var getPara, ParaVal;\r\n  var aryPara = [];\r\n\r\n  if (strUrl.indexOf(\"?\") !== -1) {\r\n    var getSearch = strUrl.split(\"?\");\r\n    getPara = getSearch[1].split(\"&\");\r\n    for (let j = 0; j < getPara.length; j++) {\r\n      ParaVal = getPara[j].split(\"=\");\r\n      aryPara.push(ParaVal[0]);\r\n      aryPara[ParaVal[0]] = ParaVal[1];\r\n    }\r\n  }\r\n  console.log(aryPara);\r\n  return aryPara;\r\n}\r\n\r\nfunction GetInLiffAppQuertString() {\r\n  var strUrl = location.search;\r\n  var getPara, ParaVal;\r\n  var aryPara = [];\r\n\r\n  if (strUrl.indexOf(\"?\") !== -1) {\r\n    var getSearch = strUrl.split(\"?\");\r\n    getPara = getSearch[1].split(\"&\");\r\n    for (let i = 0; i < getPara.length; i++) {\r\n      ParaVal = getPara[i].split(\"=\");\r\n      aryPara.push(ParaVal[0]);\r\n      aryPara[ParaVal[0]] = ParaVal[1];\r\n    }\r\n  }\r\n  console.log(aryPara);\r\n  return aryPara;\r\n}\r\n\r\n//liff.init()初始化\r\nfunction InitializeLineLiffSdk(liffId) {\r\n  liff\r\n    .init({\r\n      liffId: GetLiffId(),\r\n    })\r\n    .then(() => {\r\n      if (!liff.isLoggedIn()) {\r\n        alert(\"[Note] you're not login line now. It will turn to login page!\");\r\n        Login();\r\n        return false;\r\n      }\r\n      console.log('login OK')\r\n      KeepInitializeLineLiffSdk();\r\n\r\n    })\r\n    .catch((err) => {\r\n      alert(err.code);\r\n      alert(err.message);\r\n    });\r\n}\r\n\r\nfunction KeepInitializeLineLiffSdk() {\r\n  console.log('keep')\r\n      // start to use LIFF's api\r\n  var os = liff.getOS();\r\n\r\n  //true: Running in LINE browser\r\n  //false: Running in external browser\r\n  var isClient = liff.isInClient();\r\n\r\n  //true: The user is logged in\r\n  //false: The user is not logged in\r\n  var isLoggedIn = liff.isLoggedIn();\r\n  var userAccessToken = liff.getAccessToken();\r\n  var decodeedIdToken = liff.getDecodedIDToken();\r\n  var context = liff.getContext();\r\n\r\n  var contextType = \"\";\r\n  var contextViewType = \"\";\r\n  var contextUserId = \"\";\r\n  var contextUtouId = \"\";\r\n  var contextRoomId = \"\";\r\n  var contextGroupId = \"\";\r\n  if (context !== null) {\r\n    contextType = context.type;\r\n    contextViewType = context.viewType;\r\n    contextUserId = context.userId;\r\n    contextUtouId = context.utouId;\r\n    contextRoomId = context.roomId;\r\n    contextGroupId = context.groupId;\r\n  }\r\n\r\n  liff\r\n    .getProfile()\r\n    .then((profile) => {\r\n      profileUserId = profile.userId;\r\n      window.localStorage.setItem('profileUserId',profileUserId)\r\n      profileDisplayName = profile.displayName;\r\n      profilePictureUrl = profile.pictureUrl;\r\n      profileStatusMessage = profile.statusMessage;\r\n\r\n      //getProfile取得的資訊\r\n      // $(\"#profileUserId\").text(profileUserId);\r\n      // $(\"#profileDisplayName\").text(profileDisplayName);\r\n      // $(\"#profilePictureUrl\").text(profilePictureUrl);\r\n      // $(\"#profileStatusMessage\").text(profileStatusMessage);\r\n\r\n      //前面取得的資訊\r\n      // $(\"#os\").text(os);\r\n      // $(\"#isClient\").text(isClient);\r\n      // $(\"#isLoggedIn\").text(isLoggedIn);\r\n      // $(\"#userAccessToken\").text(userAccessToken);\r\n      // $(\"#decodeedIdToken\").text(decodeedIdToken);\r\n      // $(\"#contextType\").text(contextType);\r\n      // $(\"#contextViewType\").text(contextViewType);\r\n      // $(\"#contextUserId\").text(contextUserId);\r\n      // $(\"#contextUtouId\").text(contextUtouId);\r\n      // $(\"#contextRoomId\").text(contextRoomId);\r\n      // $(\"#contextGroupId\").text(contextGroupId);\r\n\r\n      //getProfile取得的資訊\r\n      console.log(\"profileUserId\", profileUserId);\r\n      console.log(\"profileDisplayName\", profileDisplayName);\r\n      console.log(\"profilePictureUrl\", profilePictureUrl);\r\n      console.log(\"profileStatusMessage\", profileStatusMessage);\r\n\r\n      //前面取得的資訊\r\n      console.log(\"os\", os);\r\n      console.log(\"isClient\", isClient);\r\n      console.log(\"isLoggedIn\", isLoggedIn);\r\n      console.log(\"userAccessToken\", userAccessToken);\r\n      console.log(\"decodeedIdToken\", decodeedIdToken);\r\n      console.log(\"contextType\", contextType);\r\n      console.log(\"contextUserId\", contextUserId);\r\n      console.log(\"contextUtouId\", contextUtouId);\r\n      console.log(\"contextRoomId\", contextRoomId);\r\n      console.log(\"contextGroupId\", contextGroupId);\r\n    })\r\n    .catch((err) => {\r\n      alert(err.code);\r\n      alert(err.message);\r\n    });\r\n}\r\n\r\nfunction Login() {\r\n  //liff.login({\r\n  //    redirectUri: 'https://www.google.com/'\r\n  //});\r\n\r\n  liff.login();\r\n}\r\n"]}