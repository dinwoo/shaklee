{"version":3,"sources":["liff_inital_js_template_v3.js"],"names":["ArrLiffQueryString","EncodeQuertstring","GetLiffId","DecondeUtf8","decodestring","decodeString","decodeURIComponent","console","log","GetArrQueryString","queryString","ParaVal","strUrl","aryPara","indexOf","getPara","split","i","length","push","GetInLiffAppQuertString","location","search","getSearch","liffId","liff","init","loh","then","data","getFriendship","friendFlag","KeepInitializeLineLiffSdk","alert","message","err","code","Login","catch","isClient","getOS","userAccessToken","isInClient","contextViewType","isLoggedIn","contextUserId","getAccessToken","contextUtouId","getDecodedIDToken","contextRoomId","getContext","contextType","context","contextGroupId","viewType","userId","utouId","profileDisplayName","roomId","profilePictureUrl","groupId","profileUserId","profileStatusMessage","getProfile","profile","displayName","pictureUrl","statusMessage","os","decodeedIdToken","login","$","document","DecodeQueryString","ArrQuertString","test","navigator","userAgent","show","hide"],"mappings":"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","file":"liff_inital_js_template_v3.js","sourcesContent":["var ArrLiffQueryString;\r\nvar EncodeQuertstring;\r\nvar DecodeQueryString;\r\nvar ArrQuertString;\r\n$(document).ready(function () {\r\n  if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\r\n    //mobile:只顯示網頁，讓人用掃的才能開啟\r\n    console.log('mobile');\r\n    //LIFF初始化是這段\r\n    InitializeLineLiffSdk();\r\n  \r\n    //這邊是解LIFF導轉之後特有的解QueryString\r\n    ArrLiffQueryString = GetInLiffAppQuertString();\r\n    EncodeQuertstring = ArrLiffQueryString[\"liff.state\"];\r\n    DecodeQueryString = DecondeUtf8(EncodeQuertstring);\r\n    ArrQuertString = GetArrQueryString(DecodeQueryString);\r\n\r\n  } else {\r\n    //pc:顯示qrcode\r\n    $('#QRCode').show();\r\n    $('#mainBody').hide();\r\n  }\r\n});\r\n\r\nfunction GetLiffId() {\r\n  //這段會依照每個帳戶不同更改\r\n  return \"1654884078-0nYB68dJ\";\r\n}\r\n\r\nfunction DecondeUtf8(decodestring) {\r\n  var decodeString = decodeURIComponent(decodestring);\r\n  console.log(decodeString);\r\n  return decodeString;\r\n}\r\n\r\nfunction GetArrQueryString(queryString) {\r\n  var strUrl = queryString;\r\n  var getPara, ParaVal;\r\n  var aryPara = [];\r\n\r\n  if (strUrl.indexOf(\"?\") !== -1) {\r\n    var getSearch = strUrl.split(\"?\");\r\n    getPara = getSearch[1].split(\"&\");\r\n    for (i = 0; i < getPara.length; i++) {\r\n      ParaVal = getPara[i].split(\"=\");\r\n      aryPara.push(ParaVal[0]);\r\n      aryPara[ParaVal[0]] = ParaVal[1];\r\n    }\r\n  }\r\n  console.log(aryPara);\r\n  return aryPara;\r\n}\r\n\r\nfunction GetInLiffAppQuertString() {\r\n  var strUrl = location.search;\r\n  var getPara, ParaVal;\r\n  var aryPara = [];\r\n\r\n  if (strUrl.indexOf(\"?\") !== -1) {\r\n    var getSearch = strUrl.split(\"?\");\r\n    getPara = getSearch[1].split(\"&\");\r\n    for (i = 0; i < getPara.length; i++) {\r\n      ParaVal = getPara[i].split(\"=\");\r\n      aryPara.push(ParaVal[0]);\r\n      aryPara[ParaVal[0]] = ParaVal[1];\r\n    }\r\n  }\r\n  console.log(aryPara);\r\n  return aryPara;\r\n}\r\n\r\n//liff.init()初始化\r\nfunction InitializeLineLiffSdk(liffId) {\r\n  liff\r\n    .init({\r\n      liffId: GetLiffId(),\r\n    })\r\n    .then(() => {\r\n      if (!liff.isLoggedIn()) {\r\n        alert(\"[Note] you're not login line now. It will turn to login page!\");\r\n        Login();\r\n        return false;\r\n      }\r\n      console.loh('login OK')\r\n      // 2021-03-16\r\n      liff\r\n        .getFriendship()\r\n        .then((data) => {\r\n          if (data.friendFlag) {\r\n            console.log(\"getFriendship true\");\r\n            console.log(\"getFriendship.data\", data);\r\n            console.log(\"getFriendship.data.friendFlag\", data.friendFlag);\r\n            //$.alert({\r\n            //    title: '是否已經加入官方LINE@帳號',\r\n            //    animation: 'zoom',\r\n            //    closeAnimation: 'scale',\r\n            //    content: \"您已經加入官方LINE@帳號，是否繼續？\",\r\n            //    buttons: {\r\n            //        OK: function () {\r\n            //            KeepInitializeLineLiffSdk();\r\n            //        },\r\n            //        NO: function () {\r\n            //            alert(\"881\");\r\n            //        }\r\n            //    }\r\n            //});\r\n          } else {\r\n            console.log(\"getFriendship false\");\r\n            console.log(\"getFriendship.data\", data);\r\n            //$.alert({\r\n            //    title: '是否已經加入官方LINE@帳號',\r\n            //    animation: 'zoom',\r\n            //    closeAnimation: 'scale',\r\n            //    content: \"您目前還沒有加入官方LINE@帳號，是否繼續？\",\r\n            //    buttons: {\r\n            //        OK: function () {\r\n            //            KeepInitializeLineLiffSdk();\r\n            //        },\r\n            //        NO: function () {\r\n            //            alert(\"881\");\r\n            //        }\r\n            //    }\r\n            //});\r\n\r\n            KeepInitializeLineLiffSdk();\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          alert(err.code);\r\n          alert(err.message);\r\n        });\r\n    })\r\n    .catch((err) => {\r\n      alert(err.code);\r\n      alert(err.message);\r\n    });\r\n}\r\n\r\nfunction KeepInitializeLineLiffSdk() {\r\n  console.loh('keep')\r\n      // start to use LIFF's api\r\n  var os = liff.getOS();\r\n\r\n  //true: Running in LINE browser\r\n  //false: Running in external browser\r\n  var isClient = liff.isInClient();\r\n\r\n  //true: The user is logged in\r\n  //false: The user is not logged in\r\n  var isLoggedIn = liff.isLoggedIn();\r\n  var userAccessToken = liff.getAccessToken();\r\n  var decodeedIdToken = liff.getDecodedIDToken();\r\n  var context = liff.getContext();\r\n\r\n  var contextType = \"\";\r\n  var contextViewType = \"\";\r\n  var contextUserId = \"\";\r\n  var contextUtouId = \"\";\r\n  var contextRoomId = \"\";\r\n  var contextGroupId = \"\";\r\n  if (context !== null) {\r\n    contextType = context.type;\r\n    contextViewType = context.viewType;\r\n    contextUserId = context.userId;\r\n    contextUtouId = context.utouId;\r\n    contextRoomId = context.roomId;\r\n    contextGroupId = context.groupId;\r\n  }\r\n\r\n  var profileUserId = \"\";\r\n  var profileDisplayName = \"\";\r\n  var profilePictureUrl = \"\";\r\n  var profileStatusMessage = \"\";\r\n  liff\r\n    .getProfile()\r\n    .then((profile) => {\r\n      profileUserId = profile.userId;\r\n      profileDisplayName = profile.displayName;\r\n      profilePictureUrl = profile.pictureUrl;\r\n      profileStatusMessage = profile.statusMessage;\r\n\r\n      //getProfile取得的資訊\r\n      // $(\"#profileUserId\").text(profileUserId);\r\n      // $(\"#profileDisplayName\").text(profileDisplayName);\r\n      // $(\"#profilePictureUrl\").text(profilePictureUrl);\r\n      // $(\"#profileStatusMessage\").text(profileStatusMessage);\r\n\r\n      //前面取得的資訊\r\n      // $(\"#os\").text(os);\r\n      // $(\"#isClient\").text(isClient);\r\n      // $(\"#isLoggedIn\").text(isLoggedIn);\r\n      // $(\"#userAccessToken\").text(userAccessToken);\r\n      // $(\"#decodeedIdToken\").text(decodeedIdToken);\r\n      // $(\"#contextType\").text(contextType);\r\n      // $(\"#contextViewType\").text(contextViewType);\r\n      // $(\"#contextUserId\").text(contextUserId);\r\n      // $(\"#contextUtouId\").text(contextUtouId);\r\n      // $(\"#contextRoomId\").text(contextRoomId);\r\n      // $(\"#contextGroupId\").text(contextGroupId);\r\n\r\n      //getProfile取得的資訊\r\n      console.log(\"profileUserId\", profileUserId);\r\n      console.log(\"profileDisplayName\", profileDisplayName);\r\n      console.log(\"profilePictureUrl\", profilePictureUrl);\r\n      console.log(\"profileStatusMessage\", profileStatusMessage);\r\n\r\n      //前面取得的資訊\r\n      console.log(\"os\", os);\r\n      console.log(\"isClient\", isClient);\r\n      console.log(\"isLoggedIn\", isLoggedIn);\r\n      console.log(\"userAccessToken\", userAccessToken);\r\n      console.log(\"decodeedIdToken\", decodeedIdToken);\r\n      console.log(\"contextType\", contextType);\r\n      console.log(\"contextUserId\", contextUserId);\r\n      console.log(\"contextUtouId\", contextUtouId);\r\n      console.log(\"contextRoomId\", contextRoomId);\r\n      console.log(\"contextGroupId\", contextGroupId);\r\n    })\r\n    .catch((err) => {\r\n      alert(err.code);\r\n      alert(err.message);\r\n    });\r\n}\r\n\r\nfunction Login() {\r\n  //liff.login({\r\n  //    redirectUri: 'https://www.google.com/'\r\n  //});\r\n\r\n  liff.login();\r\n}\r\n"]}